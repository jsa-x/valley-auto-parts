{% extends "base.html" %}
{% block title %}Shop | Valley Auto Parts{% endblock %}

{% block content %}

<div class="w-full">

  {# Status banner after login, etc. #}
  {% if banner %}
  <div
    class="mb-4 rounded-md border border-green-300 bg-green-100 text-green-700 text-sm font-medium px-4 py-2 text-center shadow"
  >
    {{ banner }}
  </div>
  {% endif %}

  <!-- welcome text -->
  <header class="page-header mb-6">
    <h1 class="text-xl font-semibold text-slate-800">
      Auto Parts Currently In Stock
    </h1>

    {% if logged_in %}
      <p class="text-slate-600 text-sm mt-1">
        Welcome back, {{ username }}. Add parts to your cart.
      </p>
    {% else %}
      <p class="text-slate-600 text-sm mt-1">
        Brakes, filters, and more log in to start adding items.
      </p>
    {% endif %}
  </header>

  <!-- products grid -->
  <section
    id="productsContainer"
    class="grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4"
  >
    {% for part in parts %}

    <!-- card for each part -->
    <div class="product-card bg-white border border-slate-200 rounded-xl shadow-sm flex flex-col overflow-hidden">

      <!-- image -->
      <div class="product-img-wrap bg-slate-200">
        <img
          class="product-img w-full h-44 object-cover"
          src="{{ part.img }}"
          alt="{{ part.name }}"
        >
      </div>

      <!-- info section -->
      <div class="product-info flex flex-col p-4 flex-1">

        <!-- category badge -->
        <div class="product-format mb-2">
          <span class="inline-block bg-slate-800 text-white text-[0.7rem] font-medium rounded px-2 py-1">
            {{ part.category }}
          </span>
        </div>

        <!-- part name -->
        <div class="product-title text-slate-900 font-semibold text-sm leading-snug">
          {{ part.name }}
        </div>

        <!-- fitment -->
        <div class="product-fitment text-[0.8rem] text-slate-600 mt-1">
          {{ part.fitment }}
        </div>

        <!-- description -->
        <div class="product-desc text-[0.8rem] text-slate-500 mt-3 flex-1">
          {{ part.description }}
        </div>

        <!-- bottom row price andbutton -->
        <div class="product-bottom flex items-center justify-between border-t border-slate-200 mt-4 pt-3">
          <div class="product-price text-slate-900 font-semibold text-sm">
            ${{ '%.2f'|format(part.price) }}
          </div>

          {% if logged_in %}
            <button
              class="add-btn bg-blue-600 hover:bg-blue-700 text-white text-[0.75rem] font-semibold rounded-md px-3 py-1.5 transition"
              data-id="{{ part.id }}"
            >
              Add to Cart
            </button>
          {% else %}
            <button
              class="add-btn bg-slate-400 text-white text-[0.75rem] font-semibold rounded-md px-3 py-1.5 cursor-not-allowed"
              disabled
            >
              Login to buy
            </button>
          {% endif %}
        </div>
      </div>
    </div>

    {% endfor %}
  </section>

</div>

{% endblock %}
